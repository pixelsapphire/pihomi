#include <iostream>
#include "serial.hpp"

int main(int argc, char** argv) {
    if (argc < 2) {
        std::cerr << "Serial port has to be specified. To see available devices, you may run:\n\n    ls /dev\n\n";
        return -1;
    }
    phm::serial_port arduino(argv[1], 9600);
    if (not arduino.is_open()) {
        std::cerr << "Could not open serial port to " << argv[1] << '\n';
        return -1;
    }
    while (true) {
        std::string buffer;
        std::cin >> buffer;
        arduino.write(buffer + '\n');
        buffer = arduino.read();
        std::cout << buffer;
    }
    return 0;
}
